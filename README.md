# ЧЕКЛИСТ ПЕНТЕСТЕРА
## 1 Разведка
КАКУЮ ИНФОРМАЦИЮ ИСКАТЬ:
+ Обнаружение доменных имен, принадлежащих организации
+ Обнаружение “живых” хостов в сети и составления списка их IP-адресов
+ Определение актуального статуса сетевых портов узлов из списка
+ Определение типа и версии операционной системы на исследованных машинах
+ Определение версий ПО или служб, которые находятся на сетевых портах
+ Сбор информации об используемых технологиях на веб-сайте
### 1.1 Пассивная разведка (OSINT)
+ https://dnsdumpster.com/ - для сбора информации об инфраструктуре сети
+ https://crt.sh/ - база данных открытых SSL/TLS сертификатах
+ https://www.shodan.io/ - просто шодан.
+ https://search.censys.io/ - просто censys.
+ СПАРК - система, собирающая всю доступную информацию о компаниях. https://spark-interfax.ru/ 
+ RIPE - схожая ситуация с СПАРКом, только для зарубежных организаций. https://apps.db.ripe.net/db-web-ui/fulltextsearch
+ https://osintframework.com/ - полезные ресурсы для ОСИНТа
+ https://github.com/jivoi/awesome-osint - полезные ОСИНТ-статьи
### 1.2 Активная разведка
#### DNS
+ host - Резолв IP по DNS. `host <domain>`
+ Amass - Сбор информации об инфраструктуре. `amass enum -v -d <domain>`
+ whois - протокол поиска информации о зарегистрированных доменных именах, IP-адресах и автономных системах. `whois <domain>`
+ dnslookup - опрос доменной системы. `nslookup -q=ANY example.com ns.example.com` | Также можно воспользоваться AXFR запросом, который при неправильной конфигурации DNS-сервера просто сдампит базу данных с DNS-зоной. `nslookup -q=AXFR example.com`
+ subfinder - перебор саб-доменов. `subfinder -d <домен>`
+ https://pentest-tools.com/ - много пентест-тулзов, но платно. (Надо найти бесплатно)
#### Узлы
+ nmap - имба. Примеры - https://denisnovikov.github.io/blog/stunning-examples-of-nmap-commands/ 
  + `nmap -sn --traceroute <IP>`
    + `-sn` — ping-сканирование.
    + `--traceroute` — также для того, чтобы проводить трассировку маршрута до каждого найденного узла.
  + `-PS` — TCP-SYN сканирование.
  + `-PU` — UDP сканирование.
  + `-PE; -PP; -PM` — ICMP-сканирование других типов
  + Повышение <b>скорости</b> сканирования
    + `-sn` - не делать сканирование портов после обнаружения узла
    + `-n` - отключает DNS-резолвинг
    + `-T0/T1/T2/T3/T4/T5` - опции таймингов. 0 - самый медленный, 5 - шизовый
  + Повышение <b>незаметности</b> сканирования
    + `--data-length <length>` - добавляет случайных байтов информации к каждому пакету, что помогает сделать сканирование менее заметным
    + `--randomize-hosts` - добавляет опцию перемешивающую сканирование узлов, чтобы сделать сканирование менее подозрительным при анализе трафика
  + Для повышения <b>качества</b> сканирования можно пробовать использовать TCP/UDP подключение
+ zenmap - GUI для имбы
+ masscan - сканер сети, разработанный с целью увеличения скорости сканирования крупных сегментов сети, в т.ч. всего пространства адресов IPv4
  + `masscan 10.0.0.0/8 192.168.0.0/16 172.16.0.0/12 -p80 --open-only`
    + `-D` - Для повышения скрытности можно реализовать возможность использования фиктивных хостов (decoys) с опцией -D для того, чтобы скрыть IP-адрес атакующего от IDS/IPS систем.
#### Порты
+ nmap
  + `nmap -sS <example.com>` - TCP-SYN сканирование узла
  + `nmap -sT <example.com>` - полное TCP сканирование узла
  + `nmap -sU <example.com>` - UDP сканирование узла
  + Повышение <b>скорости</b> сканирования портов
    + `-T0/T1/T2/T3/T4/T5` - опции таймингов. 0 - самый медленный, 5 - шизовый
    + `--top-ports <количество_портов>` - сканирует число из топ самых используемых портов
    + `-n` - отключает DNS-резолвинг
  + Повышение <b>скрытости</b> сканирования портов. <b>Только в локальных сетях</b>
    + `-spoof-mac` - для смены MAC-адреса
    + `-S` - для смены IP-адреса
  + Повышение <b>качества</b> сканирования портов
    + `-p-` - для сканирования всех портов
    + `-oN <имя_файла>` - для вывода инфы в файл
    + `-iL <имя_файла>` - для сканирования IP-адресов из файла
  + Комбинация
    + `sudo nmap --script <категории - скриптов>|<директория>|<имя_файла>|all <example.com>` Есть возможность использования скриптов
      + `—script-args <имя1>=<значение1>, <имя2>={<имя3>=<значение3>}, <имя4>=<значение4>` передача значений скриптам
    + `-sV` - позволяет узнать версию используемых служб
    + `-sL` - позволяет определить имя сетевогоь узла, сканирование которого и происходит
    + `-v` - выводит подробную информацию о результатах сканирования. Также -vv и -vvv
    + `-6` - позволит использовать при сканировании IPv6
    + `-Pn` - позволяет отключить проверки доступности узла с помощью ICMP пакетов, так как некоторые FireWall настроены на откидывание данных пакетов
    + Для хайпа
      + `-sN` - не устанавливает никакие биты флагов в TCP-заголовке
      + `-sF` - только FIN бит
      + `-sX` - устанавливаются FIN, PSH и URG флаги
      + `-sA` - данный тип сканирование направлен на изучение особенностей реагирования Firewall. Если порт не фильтруется, то будет возвращаться TCP ответ с флагом RST
      + `-sI` - данный метод сканирование позволяет полностью анонимно просканировать узел на информацию о состояние портов, так как сканирование происходит от лица другого узла
      + `-sW` - данный тип сканирование похож сутью работы на TCP ACK, но при этом способен определять, закрыт или открыт порт за счёт анализа поля TCP Window в RST ответе. В некоторых системах открытые порты используют положительное значение этого поля (даже в RST пакетах), а закрытые — нулевое
      + `-sM` - этот тип сканирования носит имя своего первооткрывателя, Уриела Мэймона. Техника практически такая же, как и при NULL, FIN и Xmas сканированиях, только в качестве запросов используются запросы FIN/ACK. Согласно RFC 793 (TCP), в ответ на такой запрос должен быть сгенерирован RST пакет, если порт открыт или закрыт. Однако многие BSD системы просто отбрасывают пакет, если порт открыт
## 2 Атаки первичного доступа
### 2.1 Эксплуатация уязвимостей приложений
https://github.com/OWASP/CheatSheetSeries/tree/master - имбовый гиточек от OWASP по созданию безопасных сайтов
https://github.com/swisskyrepo/PayloadsAllTheThings - имбовый гиточек с пейлоадами
+ Сбор всех возможных файлов/директорий/URLок по веб-сервису
  + ffuf - https://github.com/ffuf/ffuf 
  + WEBsPYder(имба) - https://github.com/zizzs3228/WEBsPYder
+ Поиск потенциальных точек входа
  + Админская панель
  + Место загрузки файлов
  + Место создания пользователей, аутентификации
  + Место пользовательского ввода
+ Поиск различных уязвимостей в точках входа
### 2.2 Экслпуатация уязвимостей в сетевых сервисах
+ Сканирование. `nmap -F -Pn -sT -sV -v --data-length 124 --top-ports 1000 <domain>`
+ Исследование сервиса и нахождение версии ПО
+ Поиск эксплойтов, их анализ и эксплуатация
  + MetaSploit и их подобия
    + Metasploit Framework (Free): https://www.metasploit.com/ 
    + CobaltStrike ($$$): https://www.cobaltstrike.com/ 
    + Exploit Pack ($$$): http://exploitpack.com/ 
    + Core Impact Pro ($$$): https://www.coresecurity.com/products/core-impact
  + Гитхабчек и гугл
### 2.3 Экслпуатация уязвимостей в беспроводной сети
### 2.4 Социальная инженерия
https://github.com/giuliacassara/awesome-social-engineering - юсфулл статейки
+ Сбор информации об организации и потенциальных целях
  + Сбор информации об организации по OSINT
    + Сбор по поисковикам
    + https://spark-interfax.ru/ - СПАРК
    + https://www.rusprofile.ru/ - руспрофайл
    + https://hh.ru/ - хх.ру для сбора информации про структуру компании
    + hunter.io
    + snov.io
    + intelx.io
    + Отзывы о работодателях
      + https://www.glassdoor.com/ 
      + https://maps.yandex.ru/ 
      + https://pravda-sotrudnikov.ru/
  + Инструменты
    + Infoga - https://github.com/m4ll0k/Infoga 
    + FocaPro - https://github.com/ElevenPaths/FOCA 
    + TheHarvester - https://github.com/laramies/theHarvester
  + Техники
    + SMTP User Enumeration (RCPT TO, MAIL FROM, VRFY) - энумерация (перебор) пользователей почтового сервера через протокол SMTP
    + OWA (Outlook Web Access) Enumeration - энумерация (перебор) пользователей почтового сервера через веб-страницу Outlook Web Access.
+ Подготовка сценариев
  + Техники маскирования
    + [Маскирование доменов](https://github.com/elceef/dnstwist): формирование похожих доменов, отличающихся одной буквой, цифрой, разделением и пр. символами с целью создания домена, схожего с оригиналом
    + Подмена отправителя: техника формирования письма в соответствии со стандартами RFC 822, 5322 реализуется таким образом, чтобы влиять на заголовок письма From, создавая видимость отправки письмо от стороннего лица
    + Отправка без авторизации в рамках одного домена
    + [Evil Proxy](https://github.com/kgretzky/evilginx2) (Проброс трафика через прокси): использование прокси вместо поддельных сайтов для перехвата кодов второго фактора и идеального воспроизведения зеркала сайта
  + Применение инструментов автоматизации
    + [SET](https://github.com/trustedsec/social-engineer-toolkit) (Social Engineering Toolkit)
    + [GoPhish](https://getgophish.com/)
    + Metasploit Framework
+ Применение сценариев атак и измерение результатов
  + Время запуска:
    + ранние (утренние) часы
    + середина рабочей недели (среда / четверг): чтобы сотрудники могли продолжить “ловиться” и в пятницу
  + Что может пойти не так?
    + Блокировка вашего рассыльщика: нужно иметь в виду минимум 3 варианта mail-серверов, если вы хотите отправить порядка тысячи писем
    + Реагирование на ваш сценарий социальной инженерии
  + Что измерять как результат?
    + открытие писем
    + переходы по ссылкам
    + введенные данные
    + выполнение сценария: ответные действия и прочее...
+ Сбор E-mail адресов сотрудников 
  + [Email Permutator+](http://metricsparrow.com/toolkit/email-permutator/) – автоматически составляет список возможных адресов. Просто заполните поля формы и дождитесь, пока он составит список.
  + Для верификации можно воспользоваться этими сервисами:
    + https://tools.emailhippo.com/ 
    + https://www.verifyemailaddress.org/ 
    + https://verify-email.org/ 
    + https://verifalia.com/validate-email 
    + https://quickemailverification.com/ 
    + https://www.accuwebhosting.com/blog/top-10-bulk-email-list-verification-validation-services-compared/
  + Whois
    + https://whois.ru/ 
    + https://dnschecker.org/ip-whois-lookup.php 
    + https://bgp.he.net/
  + OSINT
    + Infoga – инструмент, собирающий информацию об учетных записях электронной почты (ip,имя хоста, страна,…) из различных открытых источников (поисковые системы, серверы ключей pgp и shodan) и проверяющий, не произошла ли утечка электронной почты с помощью haveibeenpwned.com API.
    + [Maltego](https://www.maltego.com/) – мощная программа для сбора информации из различных баз данных, а также их представления в удобном для понимания формате (строит логические связи между данными).
    + [LeakCheck](https://leakcheck.io/) – поиск данных среди >7.8 млрд записей включающие более 3000 баз данных. Поиск по имени, почте, ключевым словам, паролям или корпоративным доменным именам.
    + [h8mail](https://github.com/khast3x/h8mail) – представляет собой инструмент OSINT для поиска электронных почт и нарушений, использующие различные службы взлома и разведки, или локальные нарушения (например, Collection 1 Троя Ханта, торрент “Breach Compilation”).
    + [Hunter](https://hunter.io/) – позволяет за считанные секунды найти адреса электронных почт, информацию о том, на каких ресурсах они были опубликованы, и связаться с ними.
    + Зарубежный ресурс [Datanyze.com](http://www.datanyze.com/#) также помогает наводить справки, но подходит скорее для иностранных пользователей. В нем достаточно указать название компании, в которой работает искомый человек. После этого вы получите список электронных ящиков, российские компании он почти не знает.
    + Google Dorks
    + [pagodo](https://github.com/opsdisk/pagodo) – Passive Google Dork
    + [emailrep](http://emailrep.io/) — сайт найдет на каких сервисах был зарегистрирован аккаунт, использующий определенную почту.
    + [dehashed.com](http://dehashed.com/) — проверка почты в слитых базах.
    + DuckDuckGo «@domainname.com» → поиск
  + Тулзы
    + [hydra](https://en.kali.tools/?p=220) – это распараллеленный брутфорс паролей к различным сервисам (FTP, POP3, IMAP, Telnet, HTTP Auth, NNTP, VNC, ICQ, PCNFS, CISCO и др.) для UNIX платформ. С помощью этой утилиты вы можете атаковать несколько сервисов одновременно.
    + [theHarvester](https://github.com/laramies/theHarvester) – это простой в использовании, но мощный инструмент, предназначенный для использования на этапе разведки. Он выполняет сбор информации из открытых источников (OSINT), чтобы помочь определить уровень внешних угроз домена. Инструмент собирает имена, адреса электронной почты, IP-адреса, поддомены и URL-адреса с помощью несколько общедоступных ресурсов.

















### 2.5 Переиспользование учётных данных сотрудников
